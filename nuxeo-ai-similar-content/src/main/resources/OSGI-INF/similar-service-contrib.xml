<?xml version="1.0"?>
<component name="org.nuxeo.ai.similar.content.services.SimilarServiceComponent" version="1.0">

  <implementation class="org.nuxeo.ai.similar.content.services.SimilarServiceComponent"/>

  <service>
    <provide interface="org.nuxeo.ai.similar.content.services.SimilarContentService"/>
  </service>

  <extension-point name="configuration">
    <documentation>
      Configure deduplication parameters
      <code>
        <deduplication
            name="main"
            query="SELECT * FROM Document WHERE ecm:mixinType = 'Picture' AND ecm:tag NOT IN ('not_duplicate')">
          <xpath>file:content</xpath>
        </deduplication>
      </code>
    </documentation>
    <object class="org.nuxeo.ai.similar.content.configuration.DeduplicationDescriptor"/>
  </extension-point>

  <extension-point name="filter">
    <documentation>
      Filter documents based on parameters of the filter
      <code>
        <filter id="dedup">
          <rule grant="true">
            <type>Picture</type>
            <condition>currentDocument.getPropertyValue("ecm:tags").contains('not_duplicate')</condition>
          </rule>
        </filter>
      </code>
    </documentation>
    <object class="org.nuxeo.ai.similar.content.configuration.ResultsFilter"/>
  </extension-point>

</component>
